{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\nconst API_KEY = '44946151-dc02d84f49eea13b7d5c48659';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst searchForm = document.querySelector(`.search-form`);\nconst inputField = document.querySelector(`.input-field`);\nconst resultsGalleryList = document.querySelector(`.gallery-result-list`);\nconst queryWord = document.querySelector('.query-word');\nconst moreButton = document.querySelector('.more');\nconst topButton = document.querySelector('.top');\nconst createToggle = selector => ({\n  enable: () => document.querySelector(selector).classList.remove('disabled'),\n  disable: () => document.querySelector(selector).classList.add('disabled'),\n});\nconst loader = createToggle('.spinner');\nconst loadText = createToggle('.loading-text');\nconst queryText = createToggle('.query-text');\nconst moreBtn = createToggle('.more');\nconst topBtn = createToggle('.top');\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  requestMore = inputField.value;\n  currentPage = 1;\n  fetchImages(requestMore, currentPage);\n  queryWord.textContent = inputField.value;\n});\nlet page = 1;\nlet currentPage = 1;\nlet totalHits = 0;\nlet per_page = 30;\nlet requestMore = '';\nasync function fetchImages(request, page = 1) {\n  loader.enable();\n  loadText.enable();\n  if (page === 1) {\n    resultsGalleryList.innerHTML = '';\n  }\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: request,\n        image_type: `photo`,\n        orientation: `horizontal`,\n        safesearch: `true`,\n        page,\n        per_page,\n      },\n    });\n    const totalPages = Math.ceil(response.data.totalHits / per_page);\n    if (response.data.hits) {\n      totalHits = response.data.totalHits;\n      displayImages(response.data.hits);\n      loader.disable();\n      loadText.disable();\n      queryText.enable();\n      currentPage = page;\n    } else if (page > totalPages) {\n      moreBtn.disable();\n      topBtn.disable();\n      loadText.disable;\n      loader.disable();\n      iziToast.warning({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      moreBtn.disable();\n      topBtn.disable();\n      iziToast.warning({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        backgroundColor: '#EF4040',\n        messageColor: '#fff',\n      });\n    }\n    return response.data;\n  } catch (error) {\n    loader.disable();\n    loadText.disable();\n    moreBtn.disable();\n    topBtn.disable();\n    console.error(error);\n    iziToast.warning({\n      title: 'Error',\n      message: 'An error occurred while fetching images',\n    });\n    throw new Error(`Error! status: ${res.status}`);\n  }\n}\nconst message =\n  'Sorry, there are no images matching your search query. Please try again!';\nfunction displayImages(images, page) {\n  if (page === 1) {\n    resultsGalleryList.innerHTML = '';\n  }\n  if (totalHits > images.length) {\n    moreBtn.enable();\n    topBtn.enable();\n  }\n  if (images.length === 0) {\n    loader.disable();\n    loadText.disable();\n    queryText.disable();\n    moreBtn.disable();\n    topBtn.disable();\n    iziToast.warning({\n      message: message,\n      backgroundColor: '#EF4040',\n      messageColor: `#fff`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n    setTimeout(clearValue, 2000);\n    return;\n  }\n  const imagesMarkup = images.map(makeImgItem).join('');\n  resultsGalleryList.insertAdjacentHTML('beforeend', imagesMarkup);\n  setTimeout(clearValue, 500);\n  lightbox.refresh();\n}\nfunction clearValue() {\n  inputField.value = '';\n}\nconst lightbox = new SimpleLightbox('.gallery-result-list a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  close: true,\n  className: 'simpleLightboxGallery',\n  doubleTapZoom: 2,\n  scrollZoom: true,\n  overlay: true,\n});\nfunction makeImgItem({\n  webformatURL,\n  largeImageURL,\n  tags,\n  downloads,\n  likes,\n  comments,\n  views,\n}) {\n  return `<li class=\"list-container\">\n    <div>\n      <div class=\"image-container\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n      </div>\n      <div class=\"descr-element\">\n        <ul class=\"descr-list\">\n          <li>\n            <h3>Likes</h3>\n              <p>${likes}</p>\n          </li>\n          <li>\n            <h3>Views</h3>\n              <p>${views}</p>\n          </li>\n          <li>\n            <h3>Comments</h3>\n            <p>${comments}</p>\n          </li>\n          <li>\n            <h3>Downloads</h3>\n              <p>${downloads}</p>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </li>`;\n}\nmoreButton.addEventListener('click', () => {\n  fetchImages(requestMore, currentPage + 1);\n});\nlet rect = resultsGalleryList.getBoundingClientRect();\ntopButton.addEventListener('click', () => {\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n});\n"],"names":["API_KEY","BASE_URL","searchForm","inputField","resultsGalleryList","queryWord","moreButton","topButton","createToggle","selector","loader","loadText","queryText","moreBtn","topBtn","event","requestMore","currentPage","fetchImages","totalHits","per_page","request","page","response","axios","totalPages","displayImages","iziToast","error","message","images","clearValue","imagesMarkup","makeImgItem","lightbox","SimpleLightbox","webformatURL","largeImageURL","tags","downloads","likes","comments","views"],"mappings":"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"}